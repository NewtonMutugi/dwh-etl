/* Renaming patientPK column coming from mhealth to UshauriPatientPK for the purpose of matching patient from C&T to  ones coming from ushauri. */
BEGIN
		IF  EXISTS(SELECT * FROM sys.columns  
           WHERE Name = N'PatientPK' 
             AND Object_ID = Object_ID(N'[ODS].[dbo].[Ushauri_PatientAppointments]'))
			 BEGIN
					EXEC sp_rename '[ODS].[dbo].[Ushauri_PatientAppointments].PatientPK', 'UshauriPatientPK', 'COLUMN';
			 END

		IF EXISTS(SELECT * FROM sys.columns  
           WHERE Name = N'PatientPKHash' 
             AND Object_ID = Object_ID(N'[ODS].[dbo].[Ushauri_PatientAppointments]'))
			 BEGIN
					EXEC sp_rename '[ODS].[dbo].[Ushauri_PatientAppointments].PatientPKHash', 'UshauriPatientPKHash', 'COLUMN';
			 END
		
		IF NOT EXISTS (
			  SELECT
				*
			  FROM
				INFORMATION_SCHEMA.COLUMNS
			  WHERE
				TABLE_NAME = 'Ushauri_PatientAppointments' AND COLUMN_NAME = 'patientPK')
			BEGIN
			  ALTER TABLE [ODS].[dbo].[Ushauri_PatientAppointments]
				ADD patientPK int NULL
			END;

		IF NOT EXISTS (
			  SELECT
				*
			  FROM
				INFORMATION_SCHEMA.COLUMNS
			  WHERE
				TABLE_NAME = 'Ushauri_PatientAppointments' AND COLUMN_NAME = 'PatientPKHash')
			BEGIN
			  alter table [ODS].[dbo].[Ushauri_PatientAppointments]
					add PatientPKHash nvarchar(150) null
			END;

END